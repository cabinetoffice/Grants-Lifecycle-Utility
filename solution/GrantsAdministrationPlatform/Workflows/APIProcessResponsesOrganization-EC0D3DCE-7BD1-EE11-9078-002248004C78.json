{
  "properties": {
    "connectionReferences": {
      "shared_commondataserviceforapps-2": {
        "runtimeSource": "embedded",
        "connection": {
          "connectionReferenceLogicalName": "gap_Dataverse"
        },
        "api": {
          "name": "shared_commondataserviceforapps"
        }
      }
    },
    "definition": {
      "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
      "contentVersion": "1.0.0.0",
      "parameters": {
        "$connections": {
          "defaultValue": {},
          "type": "Object"
        },
        "$authentication": {
          "defaultValue": {},
          "type": "SecureObject"
        }
      },
      "triggers": {
        "Dataverse_|_Trigger": {
          "metadata": {
            "operationMetadataId": "2781ea76-0b59-4a5d-be70-8e602c5e903d"
          },
          "type": "OpenApiConnectionWebhook",
          "inputs": {
            "host": {
              "connectionName": "shared_commondataserviceforapps-2",
              "operationId": "SubscribeWebhookTrigger",
              "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
            },
            "parameters": {
              "subscriptionRequest/message": 3,
              "subscriptionRequest/entityname": "gap_application",
              "subscriptionRequest/scope": 4,
              "subscriptionRequest/filteringattributes": "gap_importcompletedon",
              "subscriptionRequest/filterexpression": "gap_importcompletedon ne null and _gap_organization_value eq null\n"
            },
            "authentication": "@parameters('$authentication')"
          }
        }
      },
      "actions": {
        "Scope_|_Error_Handling": {
          "actions": {},
          "runAfter": {
            "Scope_|_Core_Process": [
              "TimedOut",
              "Skipped",
              "Failed"
            ]
          },
          "metadata": {
            "operationMetadataId": "903ccf33-9f0e-4a46-9d41-5304856b8ddb"
          },
          "type": "Scope"
        },
        "Scope_|_Core_Process": {
          "actions": {
            "Dataverse_|_Get_Accounts": {
              "runAfter": {
                "Get_Name": [
                  "Succeeded"
                ]
              },
              "metadata": {
                "operationMetadataId": "55d70a57-f101-4115-ae3f-a021e3fdf2eb"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps-2",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "accounts",
                  "$filter": "name eq '@{encodeUriComponent(first(outputs('Get_Name')?['body/value'])['gap_answer'])}'"
                },
                "authentication": "@parameters('$authentication')"
              }
            },
            "Switch_|_On_Match": {
              "runAfter": {
                "Dataverse_|_Get_Accounts": [
                  "Succeeded"
                ]
              },
              "cases": {
                "Case_|_No_Match_": {
                  "case": 0,
                  "actions": {
                    "Switch_|_On_Application_Type": {
                      "runAfter": {
                        "Get_Application_Type": [
                          "Succeeded"
                        ]
                      },
                      "cases": {
                        "Case_|_Individual": {
                          "case": "I am applying as an individual",
                          "actions": {
                            "Data_|_Parse_Address_(Individual)": {
                              "runAfter": {
                                "Get_Address_(Individual)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "3b948017-5cf5-49af-bc62-0578e02145f5"
                              },
                              "type": "ParseJson",
                              "inputs": {
                                "content": "@string(first(outputs('Get_Address_(Individual)')?['body/value'])['gap_answer'])",
                                "schema": {
                                  "type": "object",
                                  "properties": {
                                    "addressLine1": {
                                      "type": "string"
                                    },
                                    "addressLine2": {
                                      "type": "string"
                                    },
                                    "town": {
                                      "type": "string"
                                    },
                                    "county": {
                                      "type": "string"
                                    },
                                    "postcode": {
                                      "type": "string"
                                    }
                                  }
                                }
                              }
                            },
                            "Dataverse_|_Create_Individual_Account": {
                              "runAfter": {
                                "Data_|_Parse_Address_(Individual)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "edf22d3d-16fa-4442-a629-852280ae2c64"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "CreateRecord",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "accounts",
                                  "item/name": "@first(outputs('Get_Name')?['body/value'])['gap_answer']",
                                  "item/address1_city": "@body('Data_|_Parse_Address_(Individual)')?['town']",
                                  "item/address1_line1": "@body('Data_|_Parse_Address_(Individual)')?['addressLine1']",
                                  "item/address1_line2": "@body('Data_|_Parse_Address_(Individual)')?['addressLine2']",
                                  "item/address1_postalcode": "@body('Data_|_Parse_Address_(Individual)')?['postcode']",
                                  "item/address1_county": "@body('Data_|_Parse_Address_(Individual)')?['county']",
                                  "item/gap_ggisrecipientcategory": "Other",
                                  "item/gap_subtype": "@first(outputs('Get_Application_Type')?['body/value'])['gap_answer']",
                                  "item/gap_type": 803260006
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Dataverse_|_Update_Application_(New_Individual)": {
                              "runAfter": {
                                "Dataverse_|_Create_Individual_Account": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "78f444fa-001e-48bc-99e9-a165530c1560"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "UpdateRecord",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_applications",
                                  "recordId": "@triggerBody()?['gap_applicationid']",
                                  "item/gap_Organization@odata.bind": "accounts(@{body('Dataverse_|_Create_Individual_Account')?['accountid']})"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Get_Address_(Individual)": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_ADDRESS'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            }
                          }
                        },
                        "Case_|_Limited_Company": {
                          "case": "Limited company",
                          "actions": {
                            "Data_|_Parse_Address_(Limited_Company)": {
                              "runAfter": {
                                "Get_Address_(Limited_Company)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "7fcb11a8-f9f9-491b-b3ec-25f8aba28549"
                              },
                              "type": "ParseJson",
                              "inputs": {
                                "content": "@string(first(outputs('Get_Address_(Limited_Company)')?['body/value'])['gap_answer'])",
                                "schema": {
                                  "type": "object",
                                  "properties": {
                                    "addressLine1": {
                                      "type": "string"
                                    },
                                    "addressLine2": {
                                      "type": "string"
                                    },
                                    "town": {
                                      "type": "string"
                                    },
                                    "county": {
                                      "type": "string"
                                    },
                                    "postcode": {
                                      "type": "string"
                                    }
                                  }
                                }
                              }
                            },
                            "Dataverse_|_Create_Limited_Company_Account": {
                              "runAfter": {
                                "Get_Companies_House_Number_(Limited_Company)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "8d607af3-c923-49e6-b9e7-6c715d9d6e4a"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "CreateRecord",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "accounts",
                                  "item/name": "@first(outputs('Get_Name')?['body/value'])['gap_answer']",
                                  "item/address1_city": "@body('Data_|_Parse_Address_(Limited_Company)')?['town']",
                                  "item/address1_line1": "@body('Data_|_Parse_Address_(Limited_Company)')?['addressLine1']",
                                  "item/address1_line2": "@body('Data_|_Parse_Address_(Limited_Company)')?['addressLine2']",
                                  "item/address1_postalcode": "@body('Data_|_Parse_Address_(Limited_Company)')?['postcode']",
                                  "item/address1_county": "@body('Data_|_Parse_Address_(Limited_Company)')?['county']",
                                  "item/gap_charitycommissionnumber": "@string(first(outputs('Get_Charity_Commission_Number_(Limited_Company)')?['body/value'])?['gap_answer'])",
                                  "item/gap_companieshousenumber": "@string(first(outputs('Get_Companies_House_Number_(Limited_Company)')?['body/value'])?['gap_answer'])",
                                  "item/gap_ggisrecipientcategory": "UK company",
                                  "item/gap_subtype": "@first(outputs('Get_Application_Type')?['body/value'])['gap_answer']",
                                  "item/gap_type": 899930004
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Dataverse_|_Update_Application_(New_Limited_Company)": {
                              "runAfter": {
                                "Dataverse_|_Create_Limited_Company_Account": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "557e5316-38ae-41dd-8c5b-f79b742c3cae"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "UpdateRecord",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_applications",
                                  "recordId": "@triggerBody()?['gap_applicationid']",
                                  "item/gap_Organization@odata.bind": "accounts(@{body('Dataverse_|_Create_Limited_Company_Account')?['accountid']})"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Get_Address_(Limited_Company)": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_ADDRESS'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Get_Charity_Commission_Number_(Limited_Company)": {
                              "runAfter": {
                                "Data_|_Parse_Address_(Limited_Company)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_CHARITY_NUMBER'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Get_Companies_House_Number_(Limited_Company)": {
                              "runAfter": {
                                "Get_Charity_Commission_Number_(Limited_Company)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_COMPANIES_HOUSE'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            }
                          }
                        },
                        "Case_|_Charity": {
                          "case": "Charity",
                          "actions": {
                            "Dataverse_|_Create_Charity_Account": {
                              "runAfter": {
                                "Get_Companies_House_Number_(Charity)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "98e812da-b76c-49b3-bbe0-9f94369524f9"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "CreateRecord",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "accounts",
                                  "item/name": "@first(outputs('Get_Name')?['body/value'])['gap_answer']",
                                  "item/address1_city": "@body('Data_|_Parse_Address_(Charity)')?['town']",
                                  "item/address1_line1": "@body('Data_|_Parse_Address_(Charity)')?['addressLine1']",
                                  "item/address1_line2": "@body('Data_|_Parse_Address_(Charity)')?['addressLine2']",
                                  "item/address1_postalcode": "@body('Data_|_Parse_Address_(Charity)')?['postcode']",
                                  "item/address1_county": "@body('Data_|_Parse_Address_(Charity)')?['county']",
                                  "item/gap_charitycommissionnumber": "@string(first(outputs('Get_Charity_Commission_Number_(Charity)')?['body/value'])?['gap_answer'])",
                                  "item/gap_companieshousenumber": "@string(first(outputs('Get_Companies_House_Number_(Charity)')?['body/value'])?['gap_answer'])",
                                  "item/gap_ggisrecipientcategory": "UK charity",
                                  "item/gap_subtype": "@first(outputs('Get_Application_Type')?['body/value'])['gap_answer']",
                                  "item/gap_type": 899930001
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Dataverse_|_Update_Application_(New_Charity)": {
                              "runAfter": {
                                "Dataverse_|_Create_Charity_Account": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "8c1b9ee6-6223-4ace-844c-24cc13c8c568"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "UpdateRecord",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_applications",
                                  "recordId": "@triggerBody()?['gap_applicationid']",
                                  "item/gap_Organization@odata.bind": "accounts(@{body('Dataverse_|_Create_Charity_Account')?['accountid']})"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Get_Address_(Charity)": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_ADDRESS'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Data_|_Parse_Address_(Charity)": {
                              "runAfter": {
                                "Get_Address_(Charity)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "410ca262-fb4c-43e8-ba98-13f675579d89"
                              },
                              "type": "ParseJson",
                              "inputs": {
                                "content": "@string(first(outputs('Get_Address_(Charity)')?['body/value'])['gap_answer'])",
                                "schema": {
                                  "type": "object",
                                  "properties": {
                                    "addressLine1": {
                                      "type": "string"
                                    },
                                    "addressLine2": {
                                      "type": "string"
                                    },
                                    "town": {
                                      "type": "string"
                                    },
                                    "county": {
                                      "type": "string"
                                    },
                                    "postcode": {
                                      "type": "string"
                                    }
                                  }
                                }
                              }
                            },
                            "Get_Charity_Commission_Number_(Charity)": {
                              "runAfter": {
                                "Data_|_Parse_Address_(Charity)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_CHARITY_NUMBER'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Get_Companies_House_Number_(Charity)": {
                              "runAfter": {
                                "Get_Charity_Commission_Number_(Charity)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_COMPANIES_HOUSE'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            }
                          }
                        },
                        "Case_|_Other": {
                          "case": "Other",
                          "actions": {
                            "Data_|_Parse_Address_(Other)": {
                              "runAfter": {
                                "Get_Address_(Other)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "27206189-07eb-4cb3-b267-46139d950394"
                              },
                              "type": "ParseJson",
                              "inputs": {
                                "content": "@string(first(outputs('Get_Address_(Other)')?['body/value'])['gap_answer'])",
                                "schema": {
                                  "type": "object",
                                  "properties": {
                                    "addressLine1": {
                                      "type": "string"
                                    },
                                    "addressLine2": {
                                      "type": "string"
                                    },
                                    "town": {
                                      "type": "string"
                                    },
                                    "county": {
                                      "type": "string"
                                    },
                                    "postcode": {
                                      "type": "string"
                                    }
                                  }
                                }
                              }
                            },
                            "Dataverse_|_Create_Other_Account": {
                              "runAfter": {
                                "Get_Companies_House_Number_(Other)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "eb84f054-5e51-4c19-b69a-1f99ac40401f"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "CreateRecord",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "accounts",
                                  "item/name": "@first(outputs('Get_Name')?['body/value'])['gap_answer']",
                                  "item/address1_city": "@body('Data_|_Parse_Address_(Other)')?['town']",
                                  "item/address1_line1": "@body('Data_|_Parse_Address_(Other)')?['addressLine1']",
                                  "item/address1_line2": "@body('Data_|_Parse_Address_(Other)')?['addressLine2']",
                                  "item/address1_postalcode": "@body('Data_|_Parse_Address_(Other)')?['postcode']",
                                  "item/address1_county": "@body('Data_|_Parse_Address_(Other)')?['county']",
                                  "item/gap_charitycommissionnumber": "@string(first(outputs('Get_Charity_Commission_Number_(Other)')?['body/value'])?['gap_answer'])",
                                  "item/gap_companieshousenumber": "@string(first(outputs('Get_Companies_House_Number_(Other)')?['body/value'])?['gap_answer'])",
                                  "item/gap_ggisrecipientcategory": "Other",
                                  "item/gap_subtype": "@first(outputs('Get_Application_Type')?['body/value'])['gap_answer']",
                                  "item/gap_type": 803260005
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Dataverse_|_Update_Application_(Other)": {
                              "runAfter": {
                                "Dataverse_|_Create_Other_Account": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "4a3e7752-9bdf-4f3f-8289-1bb4ddfacf59"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "UpdateOnlyRecord",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_applications",
                                  "recordId": "@triggerBody()?['gap_applicationid']",
                                  "item/gap_Organization@odata.bind": "accounts(@{body('Dataverse_|_Create_Other_Account')?['accountid']})"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Get_Address_(Other)": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_ADDRESS'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Get_Charity_Commission_Number_(Other)": {
                              "runAfter": {
                                "Data_|_Parse_Address_(Other)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_CHARITY_NUMBER'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Get_Companies_House_Number_(Other)": {
                              "runAfter": {
                                "Get_Charity_Commission_Number_(Other)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_COMPANIES_HOUSE'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            }
                          }
                        },
                        "Case_|_Local_Authority": {
                          "case": "Local authority",
                          "actions": {
                            "Get_Address_(Local_Authority)": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_ADDRESS'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Data_|_Parse_Address_(Local_Authority)": {
                              "runAfter": {
                                "Get_Address_(Local_Authority)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "27206189-07eb-4cb3-b267-46139d950394"
                              },
                              "type": "ParseJson",
                              "inputs": {
                                "content": "@string(first(outputs('Get_Address_(Local_Authority)')?['body/value'])['gap_answer'])",
                                "schema": {
                                  "type": "object",
                                  "properties": {
                                    "addressLine1": {
                                      "type": "string"
                                    },
                                    "addressLine2": {
                                      "type": "string"
                                    },
                                    "town": {
                                      "type": "string"
                                    },
                                    "county": {
                                      "type": "string"
                                    },
                                    "postcode": {
                                      "type": "string"
                                    }
                                  }
                                }
                              }
                            },
                            "Get_Charity_Commission_Number_(Local_Authority)": {
                              "runAfter": {
                                "Data_|_Parse_Address_(Local_Authority)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_CHARITY_NUMBER'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Get_Companies_House_Number_(Local_Authority)": {
                              "runAfter": {
                                "Get_Charity_Commission_Number_(Local_Authority)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_COMPANIES_HOUSE'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Dataverse_|_Create_Local_Authority_Account": {
                              "runAfter": {
                                "Get_Companies_House_Number_(Local_Authority)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "eb84f054-5e51-4c19-b69a-1f99ac40401f"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "CreateRecord",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "accounts",
                                  "item/name": "@first(outputs('Get_Name')?['body/value'])['gap_answer']",
                                  "item/address1_city": "@body('Data_|_Parse_Address_(Local_Authority)')?['town']",
                                  "item/address1_line1": "@body('Data_|_Parse_Address_(Local_Authority)')?['addressLine1']",
                                  "item/address1_line2": "@body('Data_|_Parse_Address_(Local_Authority)')?['addressLine2']",
                                  "item/address1_postalcode": "@body('Data_|_Parse_Address_(Local_Authority)')?['postcode']",
                                  "item/address1_county": "@body('Data_|_Parse_Address_(Local_Authority)')?['county']",
                                  "item/gap_charitycommissionnumber": "@string(first(outputs('Get_Charity_Commission_Number_(Local_Authority)')?['body/value'])?['gap_answer'])",
                                  "item/gap_companieshousenumber": "@string(first(outputs('Get_Companies_House_Number_(Local_Authority)')?['body/value'])?['gap_answer'])",
                                  "item/gap_ggisrecipientcategory": "UK public body",
                                  "item/gap_subtype": "@first(outputs('Get_Application_Type')?['body/value'])['gap_answer']",
                                  "item/gap_type": 899930003
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Dataverse_|_Update_Application_(Local_Authority)": {
                              "runAfter": {
                                "Dataverse_|_Create_Local_Authority_Account": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "4a3e7752-9bdf-4f3f-8289-1bb4ddfacf59"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "UpdateOnlyRecord",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_applications",
                                  "recordId": "@triggerBody()?['gap_applicationid']",
                                  "item/gap_Organization@odata.bind": "accounts(@{outputs('Dataverse_|_Create_Local_Authority_Account')?['body/accountid']})"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            }
                          }
                        },
                        "Case_|_Non-Limited_Company": {
                          "case": "Non-limited company",
                          "actions": {
                            "Get_Address_(Non-Limited_Company)": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_ADDRESS'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Data_|_Parse_Address_(Non-Limited)": {
                              "runAfter": {
                                "Get_Address_(Non-Limited_Company)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "27206189-07eb-4cb3-b267-46139d950394"
                              },
                              "type": "ParseJson",
                              "inputs": {
                                "content": "@string(first(outputs('Get_Address_(Non-Limited_Company)')?['body/value'])['gap_answer'])",
                                "schema": {
                                  "type": "object",
                                  "properties": {
                                    "addressLine1": {
                                      "type": "string"
                                    },
                                    "addressLine2": {
                                      "type": "string"
                                    },
                                    "town": {
                                      "type": "string"
                                    },
                                    "county": {
                                      "type": "string"
                                    },
                                    "postcode": {
                                      "type": "string"
                                    }
                                  }
                                }
                              }
                            },
                            "Get_Charity_Commission_Number_(Non-Limited_Company)": {
                              "runAfter": {
                                "Data_|_Parse_Address_(Non-Limited)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_CHARITY_NUMBER'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Get_Companies_House_Number_(Non-Limited_Company)": {
                              "runAfter": {
                                "Get_Charity_Commission_Number_(Non-Limited_Company)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_COMPANIES_HOUSE'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Dataverse_|_Create_Non-Limited_Company_Account": {
                              "runAfter": {
                                "Get_Companies_House_Number_(Non-Limited_Company)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "eb84f054-5e51-4c19-b69a-1f99ac40401f"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "CreateRecord",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "accounts",
                                  "item/name": "@first(outputs('Get_Name')?['body/value'])['gap_answer']",
                                  "item/address1_city": "@body('Data_|_Parse_Address_(Non-Limited)')?['town']",
                                  "item/address1_line1": "@body('Data_|_Parse_Address_(Non-Limited)')?['addressLine1']",
                                  "item/address1_line2": "@body('Data_|_Parse_Address_(Non-Limited)')?['addressLine2']",
                                  "item/address1_postalcode": "@body('Data_|_Parse_Address_(Non-Limited)')?['postcode']",
                                  "item/address1_county": "@body('Data_|_Parse_Address_(Non-Limited)')?['county']",
                                  "item/gap_charitycommissionnumber": "@string(first(outputs('Get_Charity_Commission_Number_(Non-Limited_Company)')?['body/value'])?['gap_answer'])",
                                  "item/gap_companieshousenumber": "@string(first(outputs('Get_Companies_House_Number_(Non-Limited_Company)')?['body/value'])?['gap_answer'])",
                                  "item/gap_ggisrecipientcategory": "UK company",
                                  "item/gap_subtype": "@first(outputs('Get_Application_Type')?['body/value'])['gap_answer']",
                                  "item/gap_type": 899930005
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Dataverse_|_Update_Application_(Non-Limited_Company)": {
                              "runAfter": {
                                "Dataverse_|_Create_Non-Limited_Company_Account": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "4a3e7752-9bdf-4f3f-8289-1bb4ddfacf59"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "UpdateOnlyRecord",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_applications",
                                  "recordId": "@triggerBody()?['gap_applicationid']",
                                  "item/gap_Organization@odata.bind": "accounts(@{outputs('Dataverse_|_Create_Non-Limited_Company_Account')?['body/accountid']})"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            }
                          }
                        },
                        "Case_|_Registered_Charity": {
                          "case": "Registered charity",
                          "actions": {
                            "Get_Address_(Registered_Charity)": {
                              "runAfter": {},
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_ADDRESS'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Data_|_Parse_Address_(Registered_Charity)": {
                              "runAfter": {
                                "Get_Address_(Registered_Charity)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "27206189-07eb-4cb3-b267-46139d950394"
                              },
                              "type": "ParseJson",
                              "inputs": {
                                "content": "@string(first(outputs('Get_Address_(Registered_Charity)')?['body/value'])['gap_answer'])",
                                "schema": {
                                  "type": "object",
                                  "properties": {
                                    "addressLine1": {
                                      "type": "string"
                                    },
                                    "addressLine2": {
                                      "type": "string"
                                    },
                                    "town": {
                                      "type": "string"
                                    },
                                    "county": {
                                      "type": "string"
                                    },
                                    "postcode": {
                                      "type": "string"
                                    }
                                  }
                                }
                              }
                            },
                            "Get_Charity_Commission_Number_(Registered_Charity)": {
                              "runAfter": {
                                "Data_|_Parse_Address_(Registered_Charity)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_CHARITY_NUMBER'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Get_Companies_House_Number_(Registered_Charity)": {
                              "runAfter": {
                                "Get_Charity_Commission_Number_(Registered_Charity)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "ListRecords",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_responses",
                                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_COMPANIES_HOUSE'"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Dataverse_|_Create_Registered_Charity_Account": {
                              "runAfter": {
                                "Get_Companies_House_Number_(Registered_Charity)": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "eb84f054-5e51-4c19-b69a-1f99ac40401f"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "CreateRecord",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "accounts",
                                  "item/name": "@first(outputs('Get_Name')?['body/value'])['gap_answer']",
                                  "item/address1_city": "@body('Data_|_Parse_Address_(Registered_Charity)')?['town']",
                                  "item/address1_line1": "@body('Data_|_Parse_Address_(Registered_Charity)')?['addressLine1']",
                                  "item/address1_line2": "@body('Data_|_Parse_Address_(Registered_Charity)')?['addressLine2']",
                                  "item/address1_postalcode": "@body('Data_|_Parse_Address_(Registered_Charity)')?['postcode']",
                                  "item/address1_county": "@body('Data_|_Parse_Address_(Registered_Charity)')?['county']",
                                  "item/gap_charitycommissionnumber": "@string(first(outputs('Get_Charity_Commission_Number_(Registered_Charity)')?['body/value'])?['gap_answer'])",
                                  "item/gap_companieshousenumber": "@string(first(outputs('Get_Companies_House_Number_(Registered_Charity)')?['body/value'])?['gap_answer'])",
                                  "item/gap_ggisrecipientcategory": "UK charity",
                                  "item/gap_subtype": "@first(outputs('Get_Application_Type')?['body/value'])['gap_answer']",
                                  "item/gap_type": 899930002
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            },
                            "Dataverse_|_Update_Application_(Registered_Charity)": {
                              "runAfter": {
                                "Dataverse_|_Create_Registered_Charity_Account": [
                                  "Succeeded"
                                ]
                              },
                              "metadata": {
                                "operationMetadataId": "4a3e7752-9bdf-4f3f-8289-1bb4ddfacf59"
                              },
                              "type": "OpenApiConnection",
                              "inputs": {
                                "host": {
                                  "connectionName": "shared_commondataserviceforapps-2",
                                  "operationId": "UpdateOnlyRecord",
                                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                                },
                                "parameters": {
                                  "entityName": "gap_applications",
                                  "recordId": "@triggerBody()?['gap_applicationid']",
                                  "item/gap_Organization@odata.bind": "accounts(@{outputs('Dataverse_|_Create_Registered_Charity_Account')?['body/accountid']})"
                                },
                                "authentication": "@parameters('$authentication')"
                              }
                            }
                          }
                        }
                      },
                      "default": {
                        "actions": {
                          "Get_Address": {
                            "runAfter": {},
                            "metadata": {
                              "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                            },
                            "type": "OpenApiConnection",
                            "inputs": {
                              "host": {
                                "connectionName": "shared_commondataserviceforapps-2",
                                "operationId": "ListRecords",
                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                              },
                              "parameters": {
                                "entityName": "gap_responses",
                                "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_ADDRESS'"
                              },
                              "authentication": "@parameters('$authentication')"
                            }
                          },
                          "Data_|_Parse_Address": {
                            "runAfter": {
                              "Get_Address": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "27206189-07eb-4cb3-b267-46139d950394"
                            },
                            "type": "ParseJson",
                            "inputs": {
                              "content": "@string(first(outputs('Get_Address')?['body/value'])['gap_answer'])",
                              "schema": {
                                "type": "object",
                                "properties": {
                                  "addressLine1": {
                                    "type": "string"
                                  },
                                  "addressLine2": {
                                    "type": "string"
                                  },
                                  "town": {
                                    "type": "string"
                                  },
                                  "county": {
                                    "type": "string"
                                  },
                                  "postcode": {
                                    "type": "string"
                                  }
                                }
                              }
                            }
                          },
                          "Dataverse_|_Create_Account": {
                            "runAfter": {
                              "Data_|_Parse_Address": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "eb84f054-5e51-4c19-b69a-1f99ac40401f"
                            },
                            "type": "OpenApiConnection",
                            "inputs": {
                              "host": {
                                "connectionName": "shared_commondataserviceforapps-2",
                                "operationId": "CreateRecord",
                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                              },
                              "parameters": {
                                "entityName": "accounts",
                                "item/name": "@first(outputs('Get_Name')?['body/value'])['gap_answer']",
                                "item/address1_city": "@body('Data_|_Parse_Address')?['town']",
                                "item/address1_line1": "@body('Data_|_Parse_Address')?['addressLine1']",
                                "item/address1_line2": "@body('Data_|_Parse_Address')?['addressLine2']",
                                "item/address1_postalcode": "@body('Data_|_Parse_Address')?['postcode']",
                                "item/address1_county": "@body('Data_|_Parse_Address')?['county']",
                                "item/gap_ggisrecipientcategory": "Other",
                                "item/gap_subtype": "@first(outputs('Get_Application_Type')?['body/value'])['gap_answer']",
                                "item/gap_type": 803260005
                              },
                              "authentication": "@parameters('$authentication')"
                            }
                          },
                          "Dataverse_|_Update_Application": {
                            "runAfter": {
                              "Dataverse_|_Create_Account": [
                                "Succeeded"
                              ]
                            },
                            "metadata": {
                              "operationMetadataId": "4a3e7752-9bdf-4f3f-8289-1bb4ddfacf59"
                            },
                            "type": "OpenApiConnection",
                            "inputs": {
                              "host": {
                                "connectionName": "shared_commondataserviceforapps-2",
                                "operationId": "UpdateOnlyRecord",
                                "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                              },
                              "parameters": {
                                "entityName": "gap_applications",
                                "recordId": "@triggerBody()?['gap_applicationid']",
                                "item/gap_Organization@odata.bind": "accounts(@{outputs('Dataverse_|_Create_Account')?['body/accountid']})"
                              },
                              "authentication": "@parameters('$authentication')"
                            }
                          }
                        }
                      },
                      "expression": "@first(outputs('Get_Application_Type')?['body/value'])['gap_answer']",
                      "metadata": {
                        "operationMetadataId": "e7c8a027-2502-4da4-a182-8dde559d4409"
                      },
                      "type": "Switch"
                    },
                    "Get_Application_Type": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps-2",
                          "operationId": "ListRecords",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "gap_responses",
                          "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_TYPE'"
                        },
                        "authentication": "@parameters('$authentication')"
                      }
                    }
                  }
                },
                "Case_|_Single_Match": {
                  "case": 1,
                  "actions": {
                    "Dataverse_|_Update_Application_(Existing)": {
                      "runAfter": {},
                      "metadata": {
                        "operationMetadataId": "d420fde9-f423-46d0-b0ad-e5369b55a000"
                      },
                      "type": "OpenApiConnection",
                      "inputs": {
                        "host": {
                          "connectionName": "shared_commondataserviceforapps-2",
                          "operationId": "UpdateRecord",
                          "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                        },
                        "parameters": {
                          "entityName": "gap_applications",
                          "recordId": "@triggerBody()?['gap_applicationid']",
                          "item/gap_Organization@odata.bind": "accounts(@{first(outputs('Dataverse_|_Get_Accounts')?['body/value'])['accountid']})"
                        },
                        "authentication": "@parameters('$authentication')"
                      }
                    }
                  }
                }
              },
              "default": {
                "actions": {
                  "Dataverse_|_Update_Application_(Existing)_1": {
                    "runAfter": {},
                    "metadata": {
                      "operationMetadataId": "d420fde9-f423-46d0-b0ad-e5369b55a000"
                    },
                    "type": "OpenApiConnection",
                    "inputs": {
                      "host": {
                        "connectionName": "shared_commondataserviceforapps-2",
                        "operationId": "UpdateRecord",
                        "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                      },
                      "parameters": {
                        "entityName": "gap_applications",
                        "recordId": "@triggerBody()?['gap_applicationid']",
                        "item/gap_Organization@odata.bind": "accounts(@{first(outputs('Dataverse_|_Get_Accounts')?['body/value'])['accountid']})"
                      },
                      "authentication": "@parameters('$authentication')"
                    }
                  }
                }
              },
              "expression": "@length(outputs('Dataverse_|_Get_Accounts')?['body/value'])",
              "metadata": {
                "operationMetadataId": "59a51748-02bd-4f4b-af08-76539bfc189d"
              },
              "type": "Switch"
            },
            "Get_Name": {
              "runAfter": {},
              "metadata": {
                "operationMetadataId": "355517cf-6f1c-4ca3-bb5a-5b5326cde389"
              },
              "type": "OpenApiConnection",
              "inputs": {
                "host": {
                  "connectionName": "shared_commondataserviceforapps-2",
                  "operationId": "ListRecords",
                  "apiId": "/providers/Microsoft.PowerApps/apis/shared_commondataserviceforapps"
                },
                "parameters": {
                  "entityName": "gap_responses",
                  "$filter": "_gap_application_value eq @{triggerOutputs()?['body/gap_applicationid']} and gap_id eq 'APPLICANT_ORG_NAME'"
                },
                "authentication": "@parameters('$authentication')"
              }
            }
          },
          "runAfter": {},
          "metadata": {
            "operationMetadataId": "0cbfc8ba-46c0-4309-b42e-b5b62e8a0594"
          },
          "type": "Scope"
        }
      },
      "outputs": {}
    },
    "templateName": ""
  },
  "schemaVersion": "1.0.0.0"
}